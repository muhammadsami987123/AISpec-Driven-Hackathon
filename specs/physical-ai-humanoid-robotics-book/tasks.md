# tasks.md — Implementation Tasks (generated by /sp.tasks)

## Overview
Feature: Physical AI & Humanoid Robotics Book
Generated: 2025-11-27

### Phase 1 — Setup (project initialization)

- [ ] T001 Initialize repository structure for Docusaurus site and backend (`frontend/`, `backend/`, `infra/`) — create folders and placeholder files: `frontend/README.md`, `backend/README.md`
- [ ] T002 [P] Create `frontend` Docusaurus scaffolding: run `npx @docusaurus/init@next init frontend classic` and commit files to `frontend/` (see `frontend/docusaurus.config.ts`)
- [ ] T003 [P] Create `backend` FastAPI skeleton: `backend/app/main.py`, `backend/requirements.txt`, `backend/Dockerfile`
- [ ] T004 Create GitHub Actions workflow at `.github/workflows/deploy.yml` to build frontend and deploy to GitHub Pages (use `peaceiris/actions-gh-pages@v3`) — modify `publish_dir` to `frontend/build`
- [ ] T005 [P] Add `.specify` helper scripts reference and feature `specs/physical-ai-humanoid-robotics-book/` documentation files (`spec.md`, `plan.md`, `research.md` already present)
- [ ] T006 [P] Add project-level `README.md` with quickstart instructions (link to `specs/.../quickstart.md`) — path: `README.md`

### Phase 2 — Foundational (blocking prerequisites)

- [ ] T007 Setup CI environment variables in GitHub (document in `.github/README.md`): `OPENAI_API_KEY`, `QDRANT_URL`, `QDRANT_API_KEY`, `NEON_DATABASE_URL`, `BETTER_AUTH_SECRET`
- [ ] T008 [P] Create `backend/scripts/ingest_content.py` stub and unit test placeholder `backend/tests/test_ingest.py`
- [ ] T009 Create database schema migration scripts for Neon Postgres under `backend/db/migrations/` (include `user_profiles`, `translations`, `chat_conversations`) — SQL files
- [ ] T010 Provision Qdrant index configuration file at `backend/infra/qdrant_index.json` (chunk size config: 500 tokens)

### Phase 3 — User Stories (priority order)

US1 (P1): Docusaurus site + Chapter 1 content + GitHub Pages

- [ ] T011 [US1] Create Docusaurus `docs/chapter-1-intro.md` with learning objectives and hands-on setup (use `frontend/docs/chapter-1-intro.md`)
- [ ] T012 [US1] Add Chapter 1 diagrams (SVG) to `frontend/static/img/` and reference in `chapter-1-intro.md`
- [ ] T013 [US1] Implement sidebar entry and update `sidebars.ts` to include Chapter 1 (`frontend/sidebars.ts`)
- [ ] T014 [US1] Implement CI step to build Docusaurus and deploy to GitHub Pages (`.github/workflows/deploy.yml` previously added)
- [ ] T015 [US1] Acceptance test: `frontend` build succeeds and `index.html` exists in `frontend/build`

US2 (P1): RAG Chatbot (FastAPI backend + Qdrant ingestion + frontend widget)

- [ ] T016 [US2] Implement FastAPI endpoint `POST /api/ingest` (`backend/app/api/ingest.py`) to trigger book ingestion (stub that returns 202)
- [ ] T017 [US2] Implement FastAPI endpoint `POST /api/chat` (`backend/app/api/chat.py`) accepting `{query, conversation_id?, user_id?}` and returning `{reply, sources}` (stub)
- [ ] T018 [US2] Create Qdrant ingestion script `backend/scripts/ingest_content.py` to chunk markdown, generate embeddings (placeholder), and upsert to Qdrant — path: `backend/scripts/ingest_content.py`
- [ ] T019 [US2] Add OpenAPI contract reference `specs/physical-ai-humanoid-robotics-book/contracts/openapi.yaml` to backend router mapping (`backend/app/main.py`)
- [ ] T020 [US2] Implement frontend chatbot widget component `frontend/src/components/ChatWidget/index.tsx` and mount it in Docusaurus theme (`frontend/src/pages/_app.tsx` or theme wrapper)
- [ ] T021 [US2] Acceptance test: `POST /api/chat` returns 200 and correct JSON schema (run via `pytest -k chat_api`)

US3 (P2): Authentication & User Profiles (Better-Auth integration)

- [ ] T022 [US3] Integrate Better-Auth signup flow doc and placeholder SDK integration in `frontend/src/components/Auth/` with signup questionnaire UI — path: `frontend/src/components/Auth/SignupForm.tsx`
- [ ] T023 [US3] Create `backend/app/services/user_profile.py` to persist profile data into Neon Postgres (`backend/app/services/user_profile.py`)
- [ ] T024 [US3] Add DB migration `backend/db/migrations/0001_create_user_profiles.sql` to create `user_profiles` table (follow data-model fields)
- [ ] T025 [US3] Acceptance test: Create a profile record via test utility and confirm persisted fields (`backend/tests/test_user_profile.py`)

US4 (P2): Claude Code Subagents & Agent Skills (optional bonus)

- [ ] T026 [US4] Create subagent skeletons under `backend/agents/` — `content_validator.py`, `code_example_generator.py`, `diagram_agent.py`, `faq_generator.py`, `personalizer.py`
- [ ] T027 [US4] Add orchestration script `backend/scripts/run_agents.py` to run selected agents and store outputs under `backend/agents/output/` (use JSON files)
- [ ] T028 [US4] Acceptance check: Run `python backend/scripts/run_agents.py --agent content_validator` and produce `backend/agents/output/validate-report.json`

US5 (P3): Personalization UI + Engine

- [ ] T029 [US5] Add `Personalize this chapter` button component at `frontend/src/components/PersonalizeButton/index.tsx`
- [ ] T030 [US5] Implement personalization engine `backend/app/services/personalization.py` that maps `user_profile` to content filters (stub)
- [ ] T031 [US5] Acceptance test: Personalization toggle updates displayed content in `frontend` (unit/integration test placeholder)

US6 (P3): Urdu Translation Feature

- [ ] T032 [US6] Implement translation API endpoint `POST /api/translate` (`backend/app/api/translate.py`) that calls OpenAI for translation and caches result in `translations` table
- [ ] T033 [US6] Add DB migration `backend/db/migrations/0002_create_translations.sql`
- [ ] T034 [US6] Add frontend language toggle UI `frontend/src/components/LanguageToggle/index.tsx` and RTL support in CSS
- [ ] T035 [US6] Acceptance test: Request translation for a small chapter snippet and confirm cached DB entry created (`backend/tests/test_translation.py`)

### Final Phase — Polish & Cross-Cutting Concerns

- [ ] T036 Lint and format frontend and backend code (add `npm run lint` and `prettier` config; `backend` use `ruff`/`black`)
- [ ] T037 Add monitoring and error reporting (Sentry) configuration placeholders in `backend/Dockerfile` and `frontend` env docs
- [ ] T038 Create documentation for local dev and deployment in `specs/physical-ai-humanoid-robotics-book/quickstart.md`

## Dependencies & Execution Order
- Phase 1 (T001-T006) must complete before Phase 2 and Phase 3 tasks that depend on created folders and CI.
- Foundational (T007-T010) complete before US2 ingestion and DB-backed features (T016-T025, T032-T035).
- Many frontend tasks are parallelizable (marked with `[P]`). Backend tasks that modify the same DB schema are not parallelizable.

## Parallel opportunities (examples)
- Run `T002` (frontend scaffold) and `T003` (backend scaffold) in parallel.
- Work on `T016` (ingest endpoint) and `T020` (chat widget) in parallel once foundational infra is ready.

## Counts & Summary
- Total tasks generated: 38
- Tasks per story:
  - US1: 5
  - US2: 6
  - US3: 4
  - US4: 3
  - US5: 3
  - US6: 4
  - Setup/Foundational/Polish: 13

## Suggested MVP
- MVP scope: Complete US1 + US2 (T011-T021) + CI (T004) + ingestion stub (T018). This delivers a public book with a working chatbot (stubbed responses) and deployment.

---

Generated by `/sp.tasks` on 2025-11-27.
